#NO. 2 ASAL TIDAK JELAS
CREATE TEMPORARY TABLE temp_tabel (
    NO INT(100),
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    UMUR INT(3),
    TANGGAL_LAHIR DATE
);

LOAD DATA INFILE 'C:/Users/asus/Downloads/Basdat Tugas M7.CSV'
	INTO TABLE temp_tabel
	FIELDS TERMINATED BY ','
	ENCLOSED BY '"'
	LINES TERMINATED BY '\n'
 	IGNORE 1 ROWS;

SELECT * FROM TEMP_TABEL;

INSERT INTO MAHASISWA (NIM, NAMA, TANGGAL_LAHIR)
	SELECT NIM, NAMA, TANGGAL_LAHIR
	FROM TEMP_TABEL;

CREATE TEMPORARY TABLE temp_tabel (
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    ROW_NUMBER INT AUTO_INCREMENT PRIMARY KEY
);


#NO. 3 (MENGIKUTI NO. 2)
*kalo pake table mahasiswa
SELECT NIM, NAMA, ALAMAT
	FROM MAHASISWA
	WHERE ALAMAT NOT IN ('JAWA');

*kalo pake table TEMP_TABEL
SELECT NIM, NAMA, ASAL
	FROM TEMP_TABEL
	WHERE ASAL NOT IN ('JAWA');

#NO. 4
SELECT NIM, NAMA
	FROM MAHASISWA
	WHERE MOD(CAST(NIM AS UNSIGNED), 2) = 1;

#NO. 5
UPDATE MAHASISWA
	SET ANGKATAN = '2020'
	WHERE SUBSTRING(NIM, 1, 4) = '1620';
UPDATE MAHASISWA
	SET ANGKATAN = '2021'
	WHERE SUBSTRING(NIM, 1, 4) = '1621';
UPDATE MAHASISWA
	SET ANGKATAN = '2022'
	WHERE SUBSTRING(NIM, 1, 5) = '16422';

#NO. 6
SELECT NIM, NAMA, YEAR(now())-YEAR(TANGGAL_LAHIR) AS UMUR
FROM MAHASISWA;

SELECT NAMA, TANGGAL_LAHIR, YEAR(now()) - YEAR(TANGGAL_LAHIR) AS UMUR 
FROM MAHASISWA 
WHERE YEAR(now()) - YEAR(TANGGAL_LAHIR) < 20;

#NO. 7
ALTER TABLE MAHASISWA ADD COLUMN STATUS VARCHAR(10);

#NO. 8
UPDATE MAHASISWA SET STATUS = 'AKTIF';

#NO. 2 ASAL TIDAK JELAS
CREATE TEMPORARY TABLE temp_tabel (
    NO INT(100),
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    UMUR INT(3),
    TANGGAL_LAHIR DATE
);

LOAD DATA INFILE 'C:/Users/asus/Downloads/Basdat Tugas M7.CSV'
	INTO TABLE temp_tabel
	FIELDS TERMINATED BY ','
	ENCLOSED BY '"'
	LINES TERMINATED BY '\n'
 	IGNORE 1 ROWS;

SELECT * FROM TEMP_TABEL;

INSERT INTO MAHASISWA (NIM, NAMA, TANGGAL_LAHIR)
	SELECT NIM, NAMA, TANGGAL_LAHIR
	FROM TEMP_TABEL;

CREATE TEMPORARY TABLE temp_tabel (
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    ROW_NUMBER INT AUTO_INCREMENT PRIMARY KEY
);


#NO. 3 (MENGIKUTI NO. 2)
*kalo pake table mahasiswa
SELECT NIM, NAMA, ALAMAT
	FROM MAHASISWA
	WHERE ALAMAT NOT IN ('JAWA');

*kalo pake table TEMP_TABEL
SELECT NIM, NAMA, ASAL
	FROM TEMP_TABEL
	WHERE ASAL NOT IN ('JAWA');

#NO. 4
SELECT NIM, NAMA
	FROM MAHASISWA
	WHERE MOD(CAST(NIM AS UNSIGNED), 2) = 1;

#NO. 5
UPDATE MAHASISWA
	SET ANGKATAN = '2020'
	WHERE SUBSTRING(NIM, 1, 4) = '1620';
UPDATE MAHASISWA
	SET ANGKATAN = '2021'
	WHERE SUBSTRING(NIM, 1, 4) = '1621';
UPDATE MAHASISWA
	SET ANGKATAN = '2022'
	WHERE SUBSTRING(NIM, 1, 5) = '16422';

#NO. 6
SELECT NIM, NAMA, YEAR(now())-YEAR(TANGGAL_LAHIR) AS UMUR
FROM MAHASISWA;

SELECT NAMA, TANGGAL_LAHIR, YEAR(now()) - YEAR(TANGGAL_LAHIR) AS UMUR 
FROM MAHASISWA 
WHERE YEAR(now()) - YEAR(TANGGAL_LAHIR) < 20;

#NO. 7
ALTER TABLE MAHASISWA ADD COLUMN STATUS VARCHAR(10);

#NO. 8
UPDATE MAHASISWA SET STATUS = 'AKTIF';

#NO. 2 ASAL TIDAK JELAS
CREATE TEMPORARY TABLE temp_tabel (
    NO INT(100),
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    UMUR INT(3),
    TANGGAL_LAHIR DATE
);

LOAD DATA INFILE 'C:/Users/asus/Downloads/Basdat Tugas M7.CSV'
	INTO TABLE temp_tabel
	FIELDS TERMINATED BY ','
	ENCLOSED BY '"'
	LINES TERMINATED BY '\n'
 	IGNORE 1 ROWS;

SELECT * FROM TEMP_TABEL;

INSERT INTO MAHASISWA (NIM, NAMA, TANGGAL_LAHIR)
	SELECT NIM, NAMA, TANGGAL_LAHIR
	FROM TEMP_TABEL;

CREATE TEMPORARY TABLE temp_tabel (
    NIM VARCHAR(50),
    NAMA VARCHAR(50),
    ASAL VARCHAR(20),
    ROW_NUMBER INT AUTO_INCREMENT PRIMARY KEY
);


#NO. 3 (MENGIKUTI NO. 2)
*kalo pake table mahasiswa
SELECT NIM, NAMA, ALAMAT
	FROM MAHASISWA
	WHERE ALAMAT NOT IN ('JAWA');

*kalo pake table TEMP_TABEL
SELECT NIM, NAMA, ASAL
	FROM TEMP_TABEL
	WHERE ASAL NOT IN ('JAWA');

#NO. 4
SELECT NIM, NAMA
	FROM MAHASISWA
	WHERE MOD(CAST(NIM AS UNSIGNED), 2) = 1;

#NO. 5
UPDATE MAHASISWA
	SET ANGKATAN = '2020'
	WHERE SUBSTRING(NIM, 1, 4) = '1620';
UPDATE MAHASISWA
	SET ANGKATAN = '2021'
	WHERE SUBSTRING(NIM, 1, 4) = '1621';
UPDATE MAHASISWA
	SET ANGKATAN = '2022'
	WHERE SUBSTRING(NIM, 1, 5) = '16422';

#NO. 6
SELECT NIM, NAMA, YEAR(now())-YEAR(TANGGAL_LAHIR) AS UMUR
FROM MAHASISWA;

SELECT NAMA, TANGGAL_LAHIR, YEAR(now()) - YEAR(TANGGAL_LAHIR) AS UMUR 
FROM MAHASISWA 
WHERE YEAR(now()) - YEAR(TANGGAL_LAHIR) < 20;

#NO. 7
ALTER TABLE MAHASISWA ADD COLUMN STATUS VARCHAR(10);

#NO. 8
UPDATE MAHASISWA SET STATUS = 'AKTIF';

create table M_FAKULTAS (
K_FAKULTAS varchar (3) PRIMARY KEY NOT NULL,
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_JENJANG (
K_JENJANG varchar (3) PRIMARY KEY NOT NULL,
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_JURUSAN (
K_JURUSAN varchar (3) PRIMARY KEY NOT NULL,
K_JENJANG varchar (3),
FOREIGN KEY (K_JENJANG) REFERENCES M_JENJANG(K_JENJANG),
K_FAKULTAS varchar (3),
FOREIGN KEY (K_FAKULTAS) REFERENCES M_FAKULTAS(K_FAKULTAS),
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_PROG_STUDI (
K_PROG_STUDI varchar (3) PRIMARY KEY NOT NULL,
K_FAKULTAS varchar (3),
FOREIGN KEY (K_FAKULTAS) REFERENCES M_FAKULTAS (K_FAKULTAS),
K_JENJANG varchar (3),
FOREIGN KEY (K_JENJANG) REFERENCES M_JENJANG (K_JENJANG),
K_JURUSAN varchar (3),
FOREIGN KEY (K_JURUSAN) REFERENCES M_JURUSAN (K_JURUSAN),
SINGKAT varchar (10),
CONTENT varchar (60)
);

create table M_KELAS (
K_KELAS varchar (3) PRIMARY KEY NOT NULL,
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_SELEKSI (
K_SELEKSI varchar (3) PRIMARY KEY NOT NULL,
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_CABANG (
K_CABANG varchar (3) PRIMARY KEY NOT NULL,
SINGKAT varchar (10),
CONTENT varchar (45)
);

create table M_NEGARA (
K_NEGARA varchar (9) PRIMARY KEY NOT NULL,
CONTENT varchar (45)
);

create table M_PROPINSI (
K_PROPINSI varchar (9) PRIMARY KEY NOT NULL,
K_NEGARA varchar (9),
FOREIGN KEY (K_NEGARA) REFERENCES M_NEGARA(K_NEGARA),
CONTENT varchar (100)
);

create table M_KOTA (
K_KOTA varchar (9) PRIMARY KEY NOT NULL,
K_NEGARA varchar (9),
FOREIGN KEY (K_NEGARA) REFERENCES M_NEGARA(K_NEGARA),
K_PROPINSI varchar (9),
FOREIGN KEY (K_PROPINSI) REFERENCES M_PROPINSI(K_PROPINSI),
CONTENT varchar (100)
);


create table MAHASISWA (
NIM varchar (15) PRIMARY KEY NOT NULL,
NAMA varchar (60),
ANGKATAN INT,
K_JURUSAN varchar (3),
FOREIGN KEY (K_JURUSAN) REFERENCES M_PROG_STUDI(K_JURUSAN),
K_JENJANG varchar (3),
FOREIGN KEY (K_JENJANG) REFERENCES M_PROG_STUDI(K_JENJANG),
K_FAKULTAS varchar (3),
FOREIGN KEY (K_FAKULTAS) REFERENCES M_PROG_STUDI(K_FAKULTAS),
K_PROG_STUDI varchar(3),
FOREIGN KEY (K_PROG_STUDI) REFERENCES M_PROG_STUDI(K_PROG_STUDI),
K_SELEKSI varchar (3),
FOREIGN KEY (K_SELEKSI) REFERENCES M_SELEKSI(K_SELEKSI),
K_KELAS varchar (3),
FOREIGN KEY (K_KELAS) REFERENCES M_KELAS(K_KELAS),
K_CABANG varchar (3),
FOREIGN KEY (K_CABANG) REFERENCES M_CABANG(K_CABANG)
);
create table MHS_KOTA (
NIM varchar (15) PRIMARY KEY NOT NULL,
FOREIGN KEY (NIM) REFERENCES MAHASISWA(NIM)
K_PROPINSI varchar (9),
FOREIGN KEY (K_PROPINSI) REFERENCES M_KOTA(K_PROPINSI),
K_NEGARA varchar (9),
FOREIGN KEY (K_NEGARA) REFERENCES M_KOTA(K_NEGARA),
K_KOTA varchar (9),
FOREIGN KEY (K_KOTA) REFERENCES M_KOTA(K_KOTA),
ALAMAT varchar (100),
KODE_POS varchar (9)
);

SELECT CONSTRAINT_NAME, CONSTRAINT_TYPE
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS
WHERE TABLE_SCHEMA = ‘pbd_raissa' AND TABLE_NAME =’mhs_kota’;

RENAME TABLE M_NAMA_TABEL1 TO NAMA_TABEL1,
             M_NAMA_TABEL2 TO NAMA_TABEL2,
             ...
             M_NAMA_TABELN TO NAMA_TABELN;

DROP TABLE mhs_kota;

CREATE TABLE MHS_KOTA2 LIKE MHS_KOTA;
